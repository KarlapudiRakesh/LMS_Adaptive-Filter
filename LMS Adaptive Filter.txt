% Parameters
fs = 1000;            
t = 0:1/fs:1;         
f = 50;               
mu = 0.01;             
filter_order = 100;     
n_iterations = length(t); 

% Generate the original sine signal (desired signal)
original_signal = sin(2*pi*f*t);

% Corrupt the sine signal with noise
noise = 0.5 * randn(size(t));  % Random noise
corrupted_signal = original_signal + noise;

% Initialize adaptive filter parameters
weights = zeros(filter_order, 1); 
x_buffer = zeros(filter_order, 1); 
error_signal = zeros(1, n_iterations); 
filtered_signal = zeros(1, n_iterations); 

% LMS Algorithm
for i = 1:n_iterations
    % Shift the buffer and insert the current sample
    x_buffer = [corrupted_signal(i); x_buffer(1:end-1)];
    
    % Compute the filter output (dot product of weights and input buffer)
    y = weights' * x_buffer;
    
    % Calculate the error (difference between desired and estimated output)
    error_signal(i) = original_signal(i) - y;
    
    % Update the filter weights using LMS rule
    weights = weights + mu * error_signal(i) * x_buffer;
    
    % Store the filtered output
    filtered_signal(i) = y;
end

% Calculate Mean Absolute Error (MAE)
mae = mean(abs(original_signal - filtered_signal));

% Calculate Mean Squared Error (MSE)
mse = mean((original_signal - filtered_signal).^2);

% Display errors
fprintf('Mean Absolute Error (MAE): %.6f\n', mae);
fprintf('Mean Squared Error (MSE): %.6f\n', mse);

% Plot results
figure;

subplot(4,1,1);
plot(t, original_signal);
title('Original Sine Signal');
xlabel('Time (s)');
ylabel('Amplitude');

subplot(4,1,2);
plot(t, corrupted_signal);
title('Corrupted Sine Signal');
xlabel('Time (s)');
ylabel('Amplitude');

subplot(4,1,3);
plot(t, filtered_signal);
title('Filtered Signal using LMS');
xlabel('Time (s)');
ylabel('Amplitude');

subplot(4,1,4);
plot(t, error_signal);
title('Error Signal');
xlabel('Time (s)');
ylabel('Error');
